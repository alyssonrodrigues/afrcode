{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_negociacoesList","Bind","NegociacoesList","NegociacoesView","_mensagem","Mensagem","MensagemView","_negociacoesService","NegociacoesService","_ordemAtual","_init","listaTodos","catch","texto","error","setInterval","importaNegociacoes","event","preventDefault","negociacao","Negociacao","DateHelper","textoParaData","value","adiciona","then","_limpaFormulario","removeTodos","exibeMensagem","coluna","inverteOrdem","ordena","a","b","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\n    constructor() {\n        let $ = document.querySelector.bind(document);\n        \n        this._inputData = $(\"#data\");\n        this._inputQuantidade = $(\"#quantidade\");\n        this._inputValor = $(\"#valor\");\n         \n        this._negociacoesList = new Bind(\n            new NegociacoesList(), \n            new NegociacoesView($(\"#negociacoesView\")), \n            \"adiciona\", \"esvazia\", \"ordena\", \"inverteOrdem\");\n       \n        this._mensagem = new Bind(\n            new Mensagem(), new MensagemView($(\"#mensagemView\")),\n            \"texto\"); \n        \n        this._negociacoesService = new NegociacoesService();\n        this._ordemAtual = \"\";\n        this._init();\n    }\n    \n    _init() {\n        this._negociacoesService.listaTodos(this._negociacoesList)\n    \t\t.catch(error => this._mensagem.texto = error);\n        setInterval(() => this.importaNegociacoes(false), 30000);\n    }\n    \n    adiciona(event) {\n        event.preventDefault();\n        let negociacao = new Negociacao(\n\t\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\t\tthis._inputQuantidade.value,\n\t            this._inputValor.value);\n    \tthis._negociacoesService.adiciona(negociacao, this._negociacoesList)\n            .then(() => {\n            \tthis._mensagem.texto = \"Negociação incluída com sucesso!\";\n            \tthis._limpaFormulario();\n            }).catch(error => this._mensagem.texto = error);\n    }\n    \n    apaga() {\n    \tthis._negociacoesService.removeTodos(this._negociacoesList)\n\t\t\t.then(() => this._mensagem.texto = \"Negociações apagadas com sucesso!\")\n\t\t\t.catch(error => this._mensagem.texto = error);\n    }\n    \n    importaNegociacoes(exibeMensagem) {\n    \tthis._negociacoesService.importaNegociacoes(this._negociacoesList)\n\t\t\t.then(() => this._mensagem.texto = exibeMensagem ? \"Negociações importadas com sucesso!\" : \"\")\n\t\t\t.catch(error => this._mensagem.texto = error);\n    }\n    \n    ordena(coluna) {\n        if(this._ordemAtual == coluna) {\n            this._negociacoesList.inverteOrdem();\n        } else {\n            this._negociacoesList.ordena((a, b) => a[coluna] - b[coluna]);    \n        }\n        this._ordemAtual = coluna;\n    }\n    \n    _limpaFormulario() {\n        this._inputData.value = \"\";\n        this._inputQuantidade.value = 1;\n        this._inputValor.value = 0.0;\n        this._inputData.focus();   \n    }\n}"]}