{"version":3,"sources":["../../app-es6/daos/NegociacaoDao.js"],"names":["NegociacaoDao","connection","constants","_connection","_objStoreName","negociacaoStoreName","negociacao","Promise","resolve","reject","tx","transaction","objStore","objectStore","addRequest","add","onsuccess","onerror","event","target","error","negociacoes","promises","forEach","push","adiciona","all","removeRequest","clear","cursorRequest","openCursor","pointer","result","negociacaoStr","value","Negociacao","Date","_data","_quantidade","_valor","continue"],"mappings":";;;;;;IAAMA,a;AACL,wBAAYC,UAAZ,EAAwBC,SAAxB,EAAmC;AAAA;;AAClC,OAAKC,WAAL,GAAmBF,UAAnB;AACA,OAAKG,aAAL,GAAqBF,UAAUG,mBAA/B;AACA;;;;2BAEWC,U,EAAY;AAAA;;AACpB,UAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC1C,QAAIC,KAAK,MAAKP,WAAL,CAAiBQ,WAAjB,CAA6B,CAAC,MAAKP,aAAN,CAA7B,EAAmD,WAAnD,CAAT;AACA,QAAIQ,WAAWF,GAAGG,WAAH,CAAe,MAAKT,aAApB,CAAf;AACA,QAAIU,aAAaF,SAASG,GAAT,CAAaT,UAAb,CAAjB;AACAQ,eAAWE,SAAX,GAAuB;AAAA,YAASR,SAAT;AAAA,KAAvB;AACAM,eAAWG,OAAX,GAAqB;AAAA,YAASR,OAAOS,MAAMC,MAAN,CAAaC,KAApB,CAAT;AAAA,KAArB;AACG,IANM,CAAP;AAOA;;;sCAEmBC,W,EAAa;AAAA;;AAChC,OAAIC,WAAW,EAAf;AACAD,eAAYE,OAAZ,CAAoB;AAAA,WACnBD,SAASE,IAAT,CAAc,OAAKC,QAAL,CAAcnB,UAAd,CAAd,CADmB;AAAA,IAApB;AAEA,UAAOC,QAAQmB,GAAR,CAAYJ,QAAZ,CAAP;AACA;;;gCAEa;AAAA;;AACb,UAAO,IAAIf,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC1C,QAAIC,KAAK,OAAKP,WAAL,CAAiBQ,WAAjB,CAA6B,CAAC,OAAKP,aAAN,CAA7B,EAAmD,WAAnD,CAAT;AACA,QAAIQ,WAAWF,GAAGG,WAAH,CAAe,OAAKT,aAApB,CAAf;AACA,QAAIuB,gBAAgBf,SAASgB,KAAT,EAApB;AACAD,kBAAcX,SAAd,GAA0B;AAAA,YAASR,SAAT;AAAA,KAA1B;AACAmB,kBAAcV,OAAd,GAAwB;AAAA,YAAUR,OAAOS,MAAMC,MAAN,CAAaC,KAApB,CAAV;AAAA,KAAxB;AACG,IANM,CAAP;AAOA;;;+BAEY;AAAA;;AACZ,UAAO,IAAIb,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC1C,QAAIC,KAAK,OAAKP,WAAL,CAAiBQ,WAAjB,CAA6B,CAAC,OAAKP,aAAN,CAA7B,EAAmD,WAAnD,CAAT;AACA,QAAIQ,WAAWF,GAAGG,WAAH,CAAe,OAAKT,aAApB,CAAf;AACA,QAAIiB,cAAc,EAAlB;AACA,QAAIQ,gBAAgBjB,SAASkB,UAAT,EAApB;AACAD,kBAAcb,SAAd,GAA0B,iBAAS;AAClC,SAAIe,UAAUb,MAAMC,MAAN,CAAaa,MAA3B;AACA,SAAID,OAAJ,EAAa;AACZ,UAAIE,gBAAgBF,QAAQG,KAA5B;AACAb,kBAAYG,IAAZ,CAAiB,IAAIW,UAAJ,CACf,IAAIC,IAAJ,CAASH,cAAcI,KAAvB,CADe,EAEfJ,cAAcK,WAFC,EAGfL,cAAcM,MAHC,CAAjB;AAIAR,cAAQS,QAAR;AACA,MAPD,MAOO;AACNhC,cAAQa,WAAR;AACA;AACD,KAZD;AAaAQ,kBAAcZ,OAAd,GAAwB;AAAA,YAAST,QAAQU,MAAMC,MAAN,CAAaC,KAArB,CAAT;AAAA,KAAxB;AACG,IAnBM,CAAP;AAoBA","file":"NegociacaoDao.js","sourcesContent":["class NegociacaoDao {\n\tconstructor(connection, constants) {\n\t\tthis._connection = connection;\n\t\tthis._objStoreName = constants.negociacaoStoreName;\n\t}\n\t\n    adiciona(negociacao) {\n    \treturn new Promise((resolve, reject) => {\n\t\t\tlet tx = this._connection.transaction([this._objStoreName], \"readwrite\");\n\t\t\tlet objStore = tx.objectStore(this._objStoreName);\n\t\t\tlet addRequest = objStore.add(negociacao);\n\t\t\taddRequest.onsuccess = event => resolve();\n\t\t\taddRequest.onerror = event => reject(event.target.error);\n    \t});\n    }\n    \n    adicionaNegociacoes(negociacoes) {\n    \tlet promises = [];\n    \tnegociacoes.forEach(negociacao => \n    \t\tpromises.push(this.adiciona(negociacao)));\n    \treturn Promise.all(promises);\n    }\n\n    removeTodos() {\n    \treturn new Promise((resolve, reject) => {\n\t\t\tlet tx = this._connection.transaction([this._objStoreName], \"readwrite\");\n\t\t\tlet objStore = tx.objectStore(this._objStoreName);\n\t\t\tlet removeRequest = objStore.clear();\n\t\t\tremoveRequest.onsuccess = event => resolve();\n\t\t\tremoveRequest.onerror = event =>  reject(event.target.error);\n    \t});\n    }\n    \n    listaTodos() {\n    \treturn new Promise((resolve, reject) => {\n\t\t\tlet tx = this._connection.transaction([this._objStoreName], \"readwrite\");\n\t\t\tlet objStore = tx.objectStore(this._objStoreName);\n\t\t\tlet negociacoes = [];\n\t\t\tlet cursorRequest = objStore.openCursor();\n\t\t\tcursorRequest.onsuccess = event => {\n\t\t\t\tlet pointer = event.target.result;\n\t\t\t\tif (pointer) {\n\t\t\t\t\tlet negociacaoStr = pointer.value;\n\t\t\t\t\tnegociacoes.push(new Negociacao(\n\t\t\t\t\t\t\tnew Date(negociacaoStr._data), \n\t\t\t\t\t\t\tnegociacaoStr._quantidade,\n\t\t\t\t\t\t\tnegociacaoStr._valor));\n\t\t\t\t\tpointer.continue();\n\t\t\t\t} else {\n\t\t\t\t\tresolve(negociacoes);\n\t\t\t\t}\n\t\t\t};\n\t\t\tcursorRequest.onerror = event => resolve(event.target.error);\n    \t});\n    }\n}"]}